# Default values for todo-chatbot Helm chart

# Dapr configuration
dapr:
  enabled: true
  logLevel: info

# Frontend configuration
frontend:
  name: frontend
  replicaCount: 2
  image:
    repository: todo-frontend
    tag: v3.0
    pullPolicy: Never  # Use local images in Minikube
  service:
    type: ClusterIP
    port: 3000
    targetPort: 3000
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    - name: NODE_ENV
      value: "production"
    - name: NEXT_PUBLIC_API_URL
      value: "http://todo.local/api"
    - name: NEXT_PUBLIC_WS_URL
      value: "ws://todo.local/ws"
    - name: BETTER_AUTH_SECRET
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: better-auth-secret
    - name: BETTER_AUTH_URL
      value: "http://todo.local"
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: database-url

# Backend configuration
backend:
  name: backend
  replicaCount: 2
  image:
    repository: todo-backend
    tag: latest
    pullPolicy: Never  # Use local images in Minikube
  service:
    type: ClusterIP
    port: 8000
    targetPort: 8000
  dapr:
    enabled: true
    appId: backend
    appPort: 8000
  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  env:
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: database-url
    - name: GEMINI_API_KEY
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: gemini-api-key
    - name: BETTER_AUTH_SECRET
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: better-auth-secret
    - name: DAPR_HTTP_PORT
      value: "3500"
    - name: DAPR_GRPC_PORT
      value: "50001"

# Phase V: Notification Service
notificationService:
  name: notification-service
  replicaCount: 1
  image:
    repository: todo-notification-service
    tag: latest
    pullPolicy: Never
  service:
    type: ClusterIP
    port: 8002
    targetPort: 8002
  dapr:
    enabled: true
    appId: notification-service
    appPort: 8002
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: database-url
    - name: SMTP_HOST
      value: "smtp.gmail.com"
    - name: SMTP_PORT
      value: "587"
    - name: SMTP_USER
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: smtp-user
          optional: true
    - name: SMTP_PASSWORD
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: smtp-password
          optional: true
    - name: FROM_EMAIL
      value: "noreply@todo-app.com"

# Phase V: Recurring Task Service
recurringService:
  name: recurring-service
  replicaCount: 1
  image:
    repository: todo-recurring-service
    tag: latest
    pullPolicy: Never
  service:
    type: ClusterIP
    port: 8003
    targetPort: 8003
  dapr:
    enabled: true
    appId: recurring-service
    appPort: 8003
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    - name: BACKEND_URL
      value: "http://backend:8000"

# Phase V: Audit Service
auditService:
  name: audit-service
  replicaCount: 1
  image:
    repository: todo-audit-service
    tag: latest
    pullPolicy: Never
  service:
    type: ClusterIP
    port: 8004
    targetPort: 8004
  dapr:
    enabled: true
    appId: audit-service
    appPort: 8004
  resources:
    requests:
      memory: "256Mi"
      cpu: "250m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: todo-secrets
          key: database-url

# Ingress configuration
ingress:
  enabled: true
  className: nginx
  host: todo.local
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /$2

